Version 4
SHEET 1 912 840
WIRE 160 -176 16 -176
WIRE 752 -176 160 -176
WIRE 752 -32 16 -32
WIRE -368 48 -528 48
WIRE -112 48 -304 48
WIRE 16 48 16 -32
WIRE 16 48 -112 48
WIRE 160 80 160 -176
WIRE 400 80 160 80
WIRE 768 80 496 80
WIRE 400 128 336 128
WIRE -336 176 -336 80
WIRE -336 176 -832 176
WIRE -112 272 -112 48
WIRE -16 272 -112 272
WIRE 112 288 48 288
WIRE -16 304 -176 304
WIRE 112 352 112 288
WIRE 208 352 112 352
WIRE -480 368 -832 368
WIRE 208 368 112 368
WIRE 336 368 336 128
WIRE 336 368 272 368
WIRE -176 384 -176 304
WIRE -176 384 -416 384
WIRE -480 400 -832 400
WIRE 208 416 176 416
WIRE -336 448 -336 176
WIRE -16 448 -336 448
WIRE 112 464 112 368
WIRE 112 464 48 464
WIRE -16 480 -640 480
WIRE -304 544 -416 544
WIRE -304 624 -304 544
WIRE -16 624 -304 624
WIRE 176 640 176 416
WIRE 176 640 48 640
WIRE -16 656 -592 656
WIRE -176 768 -176 384
WIRE 496 768 -176 768
FLAG -832 176 ISENSE
IOPIN -832 176 In
FLAG -832 400 INV
IOPIN -832 400 In
FLAG -832 368 N_INV
IOPIN -832 368 In
FLAG -592 656 MAX_DUTY
IOPIN -592 656 In
FLAG -640 480 I_LIMIT
IOPIN -640 480 In
FLAG 496 768 COMP
IOPIN 496 768 Out
FLAG 768 80 PWM
IOPIN 768 80 Out
FLAG 752 -32 ISENSEA
IOPIN 752 -32 Out
FLAG 752 -176 CLK
IOPIN 752 -176 Out
SYMBOL Control\\clk -16 -176 R0
WINDOW 3 -8 128 Bottom 2
WINDOW 123 -2 69 Bottom 2
WINDOW 39 -8 100 Bottom 2
SYMATTR Value tdelay=0 Vhigh=1
SYMATTR Value2 SR=1e8 ton=0.1/{f}
SYMATTR SpiceLine f={f}
SYMATTR InstName U1
SYMBOL Control\\adder2 -336 48 R0
SYMATTR InstName U2
SYMBOL Control\\sawtooth -560 48 R0
WINDOW 3 -6 64 Bottom 2
WINDOW 123 -8 100 Bottom 2
SYMATTR Value Vlow=0 Vhigh={ma/f}
SYMATTR Value2 f={f}
SYMATTR InstName U3
SYMBOL Digital\\srflop 448 32 R0
SYMATTR InstName A1
SYMBOL Control\\comp 16 288 R0
WINDOW 3 -37 57 Left 2
WINDOW 123 -36 82 Left 2
SYMATTR Value Vhigh=1
SYMATTR Value2 Vlow=0
SYMATTR InstName U4
SYMBOL MyOpamp -496 384 R0
SYMATTR SpiceLine2 Ao = {Ao} FBW= {FBW}
SYMATTR InstName U5
SYMBOL Digital\\or 240 320 R0
SYMATTR InstName A2
SYMBOL Control\\comp 16 464 R0
WINDOW 3 -37 57 Left 2
WINDOW 123 -36 82 Left 2
SYMATTR Value Vhigh=1
SYMATTR Value2 Vlow=0
SYMATTR InstName U6
SYMBOL Control\\comp 16 640 R0
WINDOW 3 -37 57 Left 2
WINDOW 123 -36 82 Left 2
SYMATTR Value Vhigh=1
SYMATTR Value2 Vlow=0
SYMATTR InstName U7
SYMBOL Control\\sawtooth -448 544 R0
WINDOW 3 -6 64 Bottom 2
WINDOW 123 -8 100 Bottom 2
SYMATTR Value2 f={f}
SYMATTR InstName U8
